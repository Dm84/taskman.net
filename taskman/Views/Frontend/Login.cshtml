@{
    Layout = "~/Views/Frontend/Layout.cshtml";
	ViewBag.Title = "Taskman - signin";
}

@model taskman.Controllers.FrontendController.LoginModel

@section AddToHead {
	<link rel="stylesheet" type="text/css" media="screen" href="@Url.Content("/Content/css/bootstrap.css")" />	
}

<div class="col-lg-6">
	<div class="panel panel-default">
		<div class="panel-heading">
			<h1 class="h1">
				@Model.signin_header
			</h1>
		</div>
		<div class="panel-body">
			<form id="signin" class="form" role="form" method="post" action="@Model.signin_url">
				<div class="form-group">
					<input type="text"
						   class="form-control"
						   value="@Model.login"
						   name="@Model.login_param"
						   placeholder="@Model.login_placeholder" />
				</div>
				<div class="form-group">
					<input type="password"
						   class="form-control"
						   name="@Model.pwd_param"
						   placeholder="@Model.pwd_placeholder" />
				</div>
				<button class="btn btn-primary"
						type="submit">
					@Model.signup_btn_caption
				</button>
			</form>
		</div>
	</div>
</div>
<div class="col-lg-6">
	<div class="panel panel-default">
		<div class="panel-heading">
			<h1 class="h1">
				@Model.signup_header
			</h1>
		</div>
		<div class="panel-body">
			<form id="signup" class="form" role="form" method="post" action="@Model.signup_url">
				<div class="form-group">
					<input type="text"
						   class="form-control"
						   value="@Model.login"
						   name="@Model.login_param"
						   placeholder="@Model.login_placeholder" />
				</div>
				<div class="form-group">
					<input id="password"
						   type="password"
						   class="form-control"
						   name="@Model.pwd_placeholder"
						   placeholder="@Model.pwd_placeholder" />
				</div>
				<div class="form-group">
					<input id="password-confirm"
						   type="password"
						   class="form-control onkeyup"
						   name="password_confirm"
						   placeholder="@Model.pwd_confirm_placeholder" />
				</div>
				<button class="btn btn-primary" type="submit">
					@Model.signup_btn_caption
				</button>
			</form>
		</div>
	</div>
</div>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.js" type="text/javascript"></script>
<script src="@Url.Content("/Content/js/libs/bootstrap.js")" type="text/javascript"></script>
<script type="text/javascript" src="@Url.Content("/Content/js/libs/jquery.form.js")"></script>
<script type="text/javascript" src="@Url.Content("/Content/js/libs/jquery.validate.js")"></script>
<script type="text/javascript">

        $(function () {
            var shared_settings = {

                errorPlacement: function(error, element) {
                    error.insertBefore(element);
                },

                highlight: function(element, errorClass) {

                    $(element).parent().addClass('has-error');
                },

                unhighlight: function(element, errorClass) {

                    $(element).parent().removeClass('has-error');
                },

                errorClass: 'control-label'
            };

            var handleSuccess = function (data) {

                console.log('success', data);
            };

            var handleError = function (data) {

                console.log('error', data);
            };

            var submitHandler = function(form) {

                form.submit();
            };

            $('#signin').validate($.extend({

                rules: {

                    _username: {
                        required: true
                    },
                    _password: {
                        required: true
                    }
                },

                messages: {

                    _username: {
                        required: '@Model.field_req_msg'
                    },
                    _password: {
                        required: '@Model.field_req_msg'
                    }

                },

                submitHandler: submitHandler


            }, shared_settings));

            var res = $('#signup').validate($.extend({

                onkeyup: function (element, event) {
                    if ($(element).hasClass('onkeyup')) $(element).valid();
                    else if ($(element).attr('id') === 'password' && $('#password-confirm').val() !== '')
                        $('#password-confirm').valid();
                },

                messages: {

                    _password: {
                        minlength: '@Model.pwd_len_req_msg 5',
                        required: '@Model.field_req_msg'
                    },

                    password_confirm: {
                        equalTo: '@Model.pwd_confirm_req_msg'
                    },

                    _username: {
                        required: '@Model.field_req_msg'
                    }
                },

                rules: {

                    _username: {
                        required: true
                    },

                    _password: {
                        required: true,
                        minlength: 1
                    },
                    password_confirm: {
                        equalTo: '#password'
                    }
                },

                submitHandler: submitHandler

            }, shared_settings));

        });

</script>
